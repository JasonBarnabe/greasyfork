<%- title t('scripts.code_title', :script_name => @script.name(I18n.locale)) %>
<%- description 'Source code for ' + @script.name(I18n.locale) %>

<%= stylesheet_link_tag "coderay", media: "all" %>

<%=render :partial => 'install', :locals => {:script => @script, :script_version => @script_version}%>

<div id="script-feedback-suggestion">
	<%=t('scripts.feedback_suggestion_html', feedback_link: link_to(t('scripts.feedback_link_text'), "#{forum_path}post/discussion?script=#{@script.id}", rel: :nofollow))%>
</div>

<% if @highlighted_code.nil? && !SyntaxHighlightedCode.can_highlight?(@code) %>
	<p><%=t('scripts.code_highlighting_disabled', :size => number_to_human_size(Rails.configuration.syntax_highlighting_limit))%></p>
<% end %>

<div id="code-container" class="max-screen-height">
	<% if @highlighted_code.nil? %>
		<pre class="CodeRay"><%=@code%></pre>
	<% else %>
		<%=@highlighted_code.html_safe%>
	<% end %>
</div>
<script>
var cc = document.getElementById('code-container');
var fullscreen = cc.requestFullscreen || cc.webkitRequestFullscreen || cc.mozRequestFullScreen;
var exitFullscreen = document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen;
var isFullscreen = function() {
	return (document.fullscreen !== undefined ? document.fullscreen : (document.webkitIsFullScreen !== undefined ? document.webkitIsFullScreen : (document.mozFullScreen)));
};
window.addEventListener('keydown', function(event) {
	if (event.target.tagName.toLowerCase() != 'input' && event.keyCode == 70) { // f
		if (isFullscreen()) {
			exitFullscreen.apply(document);
		} else {
			fullscreen.apply(cc);
		}
	}
});
window.addEventListener("resize", function(event) {
	cc.style.maxHeight = window.innerHeight + 'px';
});
</script>